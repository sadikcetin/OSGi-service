package org.sifirbir.osgi.manager.language.impl;

import org.eclipse.osgi.framework.console.CommandInterpreter;
import org.eclipse.osgi.framework.console.CommandProvider;
import org.sifirbir.osgi.manager.api.command.IManagerCommand;

public class LanguageManagerCommand implements CommandProvider, IManagerCommand {

	public void _c(CommandInterpreter ci) {

		int serviceCount = getServiceCount();
		if (serviceCount == 0) {
			ci.println("NO SERVICE :) ");
		}
		ci.print("Service Count : " + serviceCount + "\n");

	}
	
	public void _addlang(CommandInterpreter ci) {
		String code = ci.nextArgument();
		String speak = ci.nextArgument();
		String state = ci.nextArgument();
		ci.println("code " + code);
		ci.println("speak " + speak);
		ci.println("state : " + state);
		Activator.registerDynamicLanguage(code, state, speak);
		
	}
	
	public void _print(CommandInterpreter ci) {
		ci.println(LanguageManagerImpl.getInstance().getServiceInfo());
	}

	public void _speak(CommandInterpreter ci) {
		String arg = ci.nextArgument();
		String message = null;
		if (arg != null && arg.trim().length() > 0) {
			message = LanguageManagerImpl.getInstance().speak(arg);
			if (message == null) {
				ci.println(arg + "  I Have Not Found Any Service");
			} else
				ci.println(message);
		} else {
			ci.println("speak <language_code> seklinde cagrilmasi gerekiyor");
		}
	}

	@Override
	public String getHelp() {
	    
		StringBuffer string = new StringBuffer();
		
		string.append("################################ COMMANDS ##################################\n");
		string.append("Commands                                                       Description\n");
		string.append("---------                                                        -----------\n");
		string.append("c                                 --->                  Active Service Count\n");
		string.append("speak                             --->                                 Speak\n");
		string.append("print                             --->     Print Avaliable Language Services\n");
		string.append("addlang [code] [speak] [state]    --->   Add New Lang With code,speak& state \n");
		string.append("\n");
		string.append("#############################################################################\n");

		return null;
	}

	@Override
	public int getServiceCount() {
		return LanguageManagerImpl.getInstance().getRegisteredLanguageCount();
	}

}
